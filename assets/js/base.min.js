"use strict";angular.module("casa-capp",["ui.router","ngMaterial","firebaseHelper"]).config(["$locationProvider","$urlRouterProvider","$stateProvider","$firebaseHelperProvider",function(e,t,r,o){e.html5Mode(!1),t.when("","/"),r.state("home",{url:"/",templateUrl:"views/page/home.html?rev=1",controller:"HomeCtrl"}).state("admin",{url:"/admin",templateUrl:"views/page/admin.html",controller:"AdminCtrl"}),o.namespace("mismith"),o.root("casa-capp")}]).controller("AppCtrl",["$rootScope","$state","$firebaseHelper","$location",function(e,t,r,o){e.loaded=!0,e.$state=t,e.$firebaseHelper=r,e.permission=function(){return!!o.search().permission}}]).controller("HomeCtrl",["$scope","$state","$firebaseHelper","$mdDialog","$mdDialogForm","$q",function(e,t,r,o,a,n){e.$teams=r.array("teams"),e.$games=r.array("games"),e.$scores=r.array("scores"),e.alert=function(e){alert(e)},e.getScores=function(t,r){return t?e.$scores.filter(function(e){return(e.homeTeam===t.$id||e.awayTeam===t.$id)&&(r&&e.game===r.$id||!r)}):[]},e.getPoints=function(t,r,o){if(void 0!==r){if(void 0!==o){var a=(o.homeTeam===t.$id?1:-1)*(o.home-o.away),n=Math.max(0,a),i=n/r.win*10;return i}var l=0;return angular.forEach(e.getScores(t,r),function(o){l+=e.getPoints(t,r,o)}),l}var l=0;return angular.forEach(e.getScores(t),function(r){l+=e.getPoints(t,e.$games.$getRecord(r.game),r)}),l},e.getSpread=function(e,t,r){return r?r.homeTeam===e.$id&&r.home>r.away?r.home+"-"+r.away:r.away+"-"+r.home:void 0},e.getOpponent=function(t,r){return r?e.$teams.$getRecord(r.homeTeam===t.$id?r.awayTeam:r.homeTeam):void 0},e.editScore=function(t){var i=e.$new();i.score=t.$id?r.object(e.$scores,t.$id):angular.copy(t),i.deleteScore=function(t,r){var a=n.defer();return r||confirm("Are you sure you want to permanently delete this score?")?e.$scores.$remove(e.$scores.$getRecord(t.$id)).then(function(){o.hide(),a.resolve()}):(a.reject(),a.promise)},a.show({scope:i,contentUrl:"views/template/score.html",onSubmit:function(t){return t.score.$save?t.score.$save():e.$scores.$add(t.score)}})},e.editTeam=function(t){var i=e.$new();i.team=t.$id?r.object(e.$teams,t.$id):angular.copy(t),i.deleteTeam=function(t,r){var a=n.defer();return r||confirm("Are you sure you want to permanently delete this team?")?e.$teams.$remove(e.$teams.$getRecord(t.$id)).then(function(){o.hide(),a.resolve()}):(a.reject(),a.promise)},a.show({scope:i,contentUrl:"views/template/team.html",onSubmit:function(){return i.team.$save?i.team.$save():e.$teams.$add(i.team)}})}}]).controller("AdminCtrl",["$scope","$state","$firebaseHelper",function(e,t,r){e.$teams=r.array("teams"),e.$games=r.array("games"),e.$scores=r.array("scores")}]).factory("$mdDialogForm",["$mdDialog","$q",function(e,t){return{show:function(r){return e.show(e.confirm(angular.extend({ok:"Submit",cancel:"Cancel",template:['<md-dialog ng-form="dialogForm" md-theme="{{ dialog.theme }}" aria-label="{{ dialog.ariaLabel }}">','<md-dialog-content role="document" tabIndex="-1">','<h2 class="md-title">{{ dialog.title }}</h2>','<p ng-if="dialog.content">{{ dialog.content }}</p>','<div ng-if="dialog.contentUrl" ng-include="dialog.contentUrl"></div>',"</md-dialog-content>",'<div class="md-actions">','<md-button ng-if="dialog.$type == \'confirm\'" ng-click="dialog.abort()">',"{{ dialog.cancel }}","</md-button>",'<md-button ng-disabled="dialogForm.$invalid || dialog.loading" ng-click="dialog.startLoading(); dialog.onSubmit(this).then(dialog.hide).finally(dialog.stopLoading)" class="md-primary">',"{{ dialog.ok }}","</md-button>","</div>","</md-dialog>"].join(""),onSubmit:function(){var e=t.defer();return e.resolve(),e.promise}},r||{})))}}}]).filter("length",function(){return function(e){return angular.isArray(e)?e.length:angular.isObject(e)?Object.keys(e).length:0}}).directive("loading",function(){return{restrict:"E",replace:!0,template:['<div flex layout="column" layout-align="center center">','<md-progress-circular md-mode="indeterminate"></md-progress-circular>',"</div>"].join("")}});