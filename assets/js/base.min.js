angular.module("casa-capp",["ui.router","ngMaterial","firebaseHelper"]).config(["$locationProvider","$urlRouterProvider","$stateProvider","$firebaseHelperProvider",function(e,t,r,a){e.html5Mode(!0),t.when("","/"),r.state("home",{url:"/",templateUrl:"views/page/home.html",controller:"HomeCtrl"}),a.namespace("casa-capp")}]).factory("Auth",["$rootScope","$firebaseHelper","$state","$q","$timeout",function(e,t,r,a,o){var n=t.auth();return e.$me={},n.$onAuth(function(a){if(a){var o=t.ref("data/users/"+a.uid);e.$me=t.object(o),t.ref(".info/connected").on("value",function(e){e.val()&&(o.child("online").onDisconnect().set(moment().format()),o.child("online").set(!0))}),o.update(a),"home"===r.current.name&&r.reload()}else e.$me={}}),n.$waitForMe=function(){var t=a.defer();return n.$waitForAuth().then(function(){o(function(){t.resolve(e.$me)})}),t.promise},e.$auth=n.$auth=function(){return a.when(n.$getAuth()||n["$authWithOAuth"+(e.isMobile?"Redirect":"Popup")]("facebook",{scope:"email"}))},e.$unauth=n.$unauth,n}]).controller("AppCtrl",["$rootScope","$state","$firebaseHelper","Auth",function(e,t,r){e.loaded=!0,e.$state=t,e.$firebaseHelper=r}]).controller("HomeCtrl",["$scope","$state","$firebaseHelper",function(e,t,r){e.$teams=r.array("teams"),e.$games=r.array("games"),e.$scores=r.array("scores"),e.getScores=function(t,r){return t?e.$scores.filter(function(e){return(e.homeTeam===t.$id||e.awayTeam===t.$id)&&(r&&e.game===r.$id||!r)}):[]},e.getPoints=function(t,r,a){if(void 0!==r){if(void 0!==a){var o=(a.homeTeam===t.$id?1:-1)*(a.home-a.away),n=Math.max(0,o),i=n/r.win*10;return i}var u=0;return angular.forEach(e.getScores(t,r),function(a){u+=e.getPoints(t,r,a)}),u}var u=0;return angular.forEach(e.getScores(t),function(r){u+=e.getPoints(t,e.$games.$getRecord(r.game),r)}),u},e.getSpread=function(e,t,r){return r?r.homeTeam===e.$id&&r.home>r.away?r.home+"-"+r.away:r.away+"-"+r.home:void 0},e.getOpponent=function(t,r){return r?e.$teams.$getRecord(r.homeTeam===t.$id?r.awayTeam:r.homeTeam):void 0}}]).filter("length",function(){return function(e){return angular.isArray(e)?e.length:angular.isObject(e)?Object.keys(e).length:0}}).directive("loading",function(){return{restrict:"E",replace:!0,template:['<div flex layout="column" layout-align="center center">','<md-progress-circular md-mode="indeterminate"></md-progress-circular>',"</div>"].join("")}});